# v6.1.9 Gap Analysis Test Cases - Patch Plan

**Version:** 6.1.9
**Branch:** `v6.1.9-gap-analysis_test-cases`
**Type:** Improvement/Enhancement
**Date:** 2025-12-30
**Status:** In Progress

---

## Summary

Consolidate and expand test case coverage for Phases 2-4 by merging Sonnet's baseline tests with Opus expansions, corrections, and gap-filling tests. Additionally, add industry-standard skill priority weights (3:2:1 model) to scoring methodology across all relevant system files.

---

## Problem Statement

The existing test suite had gaps in Phase 2-4 coverage:
1. Sonnet's 32 baseline tests covered happy paths but missed edge cases
2. Logic errors existed in some test definitions (e.g., INC-004 index direction)
3. Boundary conditions were not tested (score = 30, confidence = 0.5)
4. Error recovery and blocking gate combinations were untested

---

## Changes

### Files Created

| File | Location | Description |
|------|----------|-------------|
| `v6.1.9-consolidated-test-cases.md` | `docs/plans/v6.1.5-testing/` | 79 merged test cases (Sonnet + Opus) |
| `v6.1.5-opus-expanded-test-cases.md` | `docs/plans/v6.1.5-testing/` | 47 Opus expansion tests with FIX series |

### Files Modified

| File | Change |
|------|--------|
| `v6.1.5-test-results.md` | Add execution results for new tests |
| `core/fit-thresholds.md` | Add skill-level priority weights (3:2:1 model) |
| `phases/phase-2/evidence-matching.md` | Update scoring formula with priority weights |
| `PROJECT-INSTRUCTIONS.md` | Add skill priority weights to scoring methodology |
| `quick-start-phase.md` | Add skill priority weights to scoring methodology |
| `docs/CHANGELOG.md` | Add v6.1.9 release notes |

---

## Detailed Change Rationale

### Why Skill Priority Weights Were Needed

**Problem:** The existing scoring methodology had category-level weights (50%/30%/20%) but no distinction between Required and Preferred skills within those categories. This meant:
- Missing "Python (Required)" had the same impact as missing "Terraform (Preferred)"
- Scoring didn't reflect how recruiters actually evaluate candidates
- Test case FIX-008 exposed this gap in the scoring logic

**Solution:** Added 3:2:1 priority weights based on industry ATS best practices:
- Required skills: 1.5x weight (priority 3)
- Preferred skills: 1.0x weight (priority 2)
- Optional skills: 0.5x weight (priority 1)

**Sources:** Rezi.ai ATS Resume Checker, Recruiterflow, Jobscan

### Files Changed and Why

| File | What Was Added | Why |
|------|----------------|-----|
| `core/fit-thresholds.md` | `<skill_priority_scoring>` XML block with 3:2:1 model | Central definition of weights for reference |
| `phases/phase-2/evidence-matching.md` | Priority-weighted scoring formula and example table | This is where the actual score calculation happens |
| `PROJECT-INSTRUCTIONS.md` | `<skill_priority_scoring>` XML block in Step 3 | System prompt needs weights for LLM to apply them |
| `quick-start-phase.md` | `<skill_priority_scoring>` XML block in Step 3 | Quick-start version also needs weights |
| `docs/CHANGELOG.md` | v6.1.9 release notes with Added/Changed/Fixed sections | Document the release for users |

### Version Header Updates

Both system prompt files updated from v6.1.7 â†’ v6.1.9:
- `PROJECT-INSTRUCTIONS.md` - Line 1 and Line 6 version comments
- `quick-start-phase.md` - Line 1 and Line 6 version comments

### Test Case Additions

| Category | Count | Author | Focus |
|----------|-------|--------|-------|
| INT | 8 | Sonnet | Phase 2 Integration |
| INC | 10 | Sonnet | Incremental Updates |
| DIFF | 7 | Sonnet | Re-Comparison |
| SUM | 7 | Sonnet | Summary Generation |
| INTX | 8 | Opus | Extended Integration |
| INCX | 10 | Opus | Extended Incremental |
| DIFFX | 7 | Opus | Extended Diff |
| SUMX | 8 | Opus | Extended Summary |
| GATE | 7 | Opus | Blocking Gate Combinations |
| ERR | 7 | Opus | Error Recovery |
| FIX | 12 | Opus | Logic Corrections & Gaps |
| **Total** | **79** | | |

---

## Sonnet Logic Corrections Applied

| Original Test | Issue | Correction |
|---------------|-------|------------|
| INC-004 | Said indices "shifted up" | Corrected to "shifted DOWN" |
| SUM-005 | Used score 42 as threshold | Corrected to use gate threshold (<30) |
| INT-007 | No weight ratios specified | Added: Required = 1.5x Preferred |
| INT-006 | Confidence "> 0.5" ambiguous | Clarified: ">= 0.5" (inclusive) |

---

## Implementation Checklist

### Phase 1: Test Case Development
- [x] Review Sonnet's test cases for logic issues
- [x] Create Opus expanded test cases (INTX, INCX, DIFFX, SUMX, GATE, ERR)
- [x] Create FIX series for logic corrections and gaps
- [x] Merge all tests into consolidated file
- [x] Create patch plan document

### Phase 2: Skill Priority Weights
- [x] Add 3:2:1 skill priority weights to `core/fit-thresholds.md`
- [x] Update scoring formula in `phases/phase-2/evidence-matching.md`
- [x] Add skill priority weights to `PROJECT-INSTRUCTIONS.md`
- [x] Add skill priority weights to `quick-start-phase.md`

### Phase 3: Finalization
- [x] Create git branch (`v6.1.9-gap-analysis_test-cases`)
- [x] Execute P0/P1 priority tests
- [x] Update test results file
- [x] Update `docs/CHANGELOG.md` with v6.1.9 release notes
- [ ] Commit and push final changes

---

## Test Execution Priority

| Priority | Tests | Rationale |
|----------|-------|-----------|
| P0 (Critical) | GATE-*, ERR-001 to ERR-003, FIX-004 to FIX-010 | Blocking gates, data integrity |
| P1 (High) | INT-*, INTX-001 to INTX-004, DIFF-001, DIFFX-001 | Core workflow |
| P2 (Medium) | INC-*, INCX-*, SUM-*, SUMX-* | Feature completeness |
| P3 (Low) | Remaining | Edge cases |

---

## Success Criteria

- [ ] All 79 test cases documented in consolidated file
- [ ] Logic corrections applied to Sonnet baseline
- [ ] P0 and P1 tests executed with results recorded
- [ ] No blocking issues identified

---

## Related Files

### Test Documentation
- `docs/plans/v6.1.5-testing/v6.1.9-consolidated-test-cases.md`
- `docs/plans/v6.1.5-testing/v6.1.5-opus-expanded-test-cases.md`
- `docs/plans/v6.1.5-testing/v6.1.5-sonnet-test-cases.md`
- `docs/plans/v6.1.5-testing/v6.1.5-test-results.md`

### Scoring Methodology Updates
- `core/fit-thresholds.md` - Skill priority weights definition
- `phases/phase-2/evidence-matching.md` - Scoring formula implementation
- `PROJECT-INSTRUCTIONS.md` - System prompt (full version)
- `quick-start-phase.md` - System prompt (quick start version)

### Release Documentation
- `docs/CHANGELOG.md` - Version history

---

## Skill Priority Weights (v6.1.9 Addition)

Based on industry ATS scoring best practices (Rezi.ai, Jobscan, Recruiterflow):

| Skill Type | Priority | Weight | Description |
|------------|----------|--------|-------------|
| Required | 3 | 1.5x | "Required", "Must have", "Essential" |
| Preferred | 2 | 1.0x | "Preferred", "Nice to have", "Bonus" |
| Optional | 1 | 0.5x | Inferred from context, not emphasized |

**Impact:** Missing a Required skill has 1.5x the negative impact of missing a Preferred skill.
