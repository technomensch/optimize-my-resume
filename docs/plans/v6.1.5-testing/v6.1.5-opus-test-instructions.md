# Test Case Gap-Filling for v6.0 Phases 2-4 (OPUS INSTRUCTIONS)

**Goal:** Create test cases for Phases 2-4 to supplement the existing 95+ test cases in `v6.0-deep-dive-test-cases.md`.

**Deliverable:** A new file (e.g., `docs/plans/v6.1.5-new-test-cases-final.md`) containing 60+ new test cases, incorporating and expanding upon the baseline cases provided by Sonnet.

---

## Context
- v6.0 is fully implemented across 4 phases.
- Existing test file covers Phase 1 comprehensively (JD parser, skills categorizer, router basics).
- **Sonnet has provided 32 baseline test cases** in `docs/plans/v6.1.5-sonnet-test-cases.md`.
- Gaps still exist in Phase 2-4 integration flows and edge cases. Opus should use Sonnet's cases as a foundation and expand with higher complexity scenarios.

---

## Test Coverage Gaps Identified

### Gap 1: Phase 2 Integration Flow (Mode 1 → Mode 3)
**Missing:** End-to-end integration tests validating data flow from job history creation to evidence matching.

**Required Test Cases (~8 tests):**
1. **INT-001:** User runs Phase 1 (creates job history v2.0) → immediately runs Phase 3 (JD comparison).
2. **INT-002:** User has v1.0 job history → runs Phase 3 (backward compatibility).
3. **INT-003:** Phase 1 creates job history with missing sections (no education/certifications).
4. **INT-004:** Job history has duplicate skills across positions.
5. **INT-005:** Phase 1 creates job history with overlapping dates (moonlighting scenario).
6. **INT-006:** JD requirement matches achievement but not explicit skill listing.
7. **INT-007:** JD has "Required" and "Preferred" skills → job history matches some of each.
8. **INT-008:** Blocking gates trigger (hard skill deficit, low match score, location mismatch).

### Gap 2: Phase 3 Incremental Updates
**Missing:** Edge case tests for add/edit/remove position operations.

**Required Test Cases (~10 tests):**
1. **INC-001:** User adds new position to job history (most recent role).
2. **INC-002:** User adds position in the middle (not most recent).
3. **INC-003:** User edits existing position (updates achievements).
4. **INC-004:** User removes position from job history.
5. **INC-005:** User adds position with no hard skills.
6. **INC-006:** User edits position dates (extending duration).
7. **INC-007:** User adds position with company that already exists in history.
8. **INC-008:** User removes last remaining position.
9. **INC-009:** User adds position with future start date (error case).
10. **INC-010:** User adds position while Phase 3 comparison is in progress.

### Gap 3: Phase 3 Re-Comparison with Diff Output
**Missing:** Diff accuracy validation tests.

**Required Test Cases (~7 tests):**
1. **DIFF-001:** User updates job history (adds Python skill) → re-runs previous JD comparison.
2. **DIFF-002:** User re-runs comparison without any job history changes.
3. **DIFF-003:** Score delta calculation accuracy.
4. **DIFF-004:** User updates job history but removes a previously matched skill.
5. **DIFF-005:** JD cached version mismatch (cache is v1, current schema is v2).
6. **DIFF-006:** User runs re-comparison with different job history version (v1.0 → v2.0 upgrade).
7. **DIFF-007:** User deletes cached JD → tries to re-compare.

### Gap 4: Phase 4 Professional Summary Validation
**Missing:** Summary quality and accuracy tests.

**Required Test Cases (~7 tests):**
1. **SUM-001:** Master summary generation from complete job history (3 positions).
2. **SUM-002:** Master summary from single position.
3. **SUM-003:** Per-JD summary customization.
4. **SUM-004:** Summary generation with no quantified metrics in job history.
5. **SUM-005:** Per-JD summary when match score < 50.
6. **SUM-006:** Summary exceeds 350 character limit.
7. **SUM-007:** User has career change.

---

## Deliverable Format

For each test case, follow this table structure:

| Test ID | Scenario | Input | Expected Output | Validation Rule |
|---------|----------|-------|-----------------|-----------------|
| [ID] | [Description] | [What user provides] | [What system should do] | [How to verify correctness] |

---

## Files to Reference
- `phases/phase-2/evidence-matching.md`
- `phases/phase-3/incremental-updates.md`
- `phases/phase-3/re-comparison.md`
- `phases/phase-4/summary-generation.md`
- `docs/plans/v6.0-deep-dive-test-cases.md` (existing coverage)
